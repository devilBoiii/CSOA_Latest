{% extends 'cso_app/layouts/back_end_navbar.html' %}
{% load static %}
{% block content %}
<title>CSOA Financial Links</title>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css"/>
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

<style>
    @import url('https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900&display=swap');
    body {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        overflow-x: hidden;
    }
    #back_end_home{
        z-index: -1;
        width: 100%;
    }
    #back_end_home .banner{
        background-color: #888;
        width:100%;
        height: 37px;
    }
    #back_end_home .banner h3, #back_end_home .banner i{
        font-size:1em;
        display: inline-block;
        padding: 0em 9em;
    }
    #back_end_home .banner i{
        padding-top: 0.5em;
    }
    #back_end_home .banner h3{
        margin-left: -15em;
    }
    .banner a{
        color: #000;
        text-decoration: none;
    }
    .banner a:hover{
        text-decoration: underline;
    }
    #master_data_cso{
        margin-left:14em;
        width: 1000px;
    }
    .nav-item a{
        color: #000;
        font-size: 0.9em;
    }
    .nav-item .nav-link.active{
        color: #20A3F5;
    }
    #tabs-1{
        margin-left: 10px;
        width: 900px;
    }
    #tabs-1, #tabs-2, #tabs-3{
        width: 90%;
    }
    .adding_icon{
        display:flex;
        float: right;
    }
    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .close {
        padding: 0;
        margin: 0;
        background: none;
        border: none;
        font-size: 1.3em;
    }
    .financial_group, .attachment_form, .cso_closing_form{
        padding: 0em 2em;
    }
    .dropdown-menu a button{
        width: 100%;
    }
</style>
<br><br><br><br><br>
<div id="back_end_home" class="container">
    <div class="banner">
        <i class="fa fa-home" aria-hidden="true"></i> <h3><a href="{% url 'administrator' %}">Home</a> > <a href="#">System Setup</a> > <a href="{% url 'cso_master_links' %}">CSO Master</a> > CSO Master Links</h3>
        <hr>
    </div>
    <br>
    <div class="row" id="master_data_cso">   
        <ul class="nav nav-tabs" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" data-toggle="tab" href="#tabs-1" role="tab"><i class="fa-solid fa-folder"></i> Financial Class</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#tabs-2" role="tab"><i class="fa-solid fa-folder-open"></i> Financial Group</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#tabs-3" role="tab"><i class="fa-solid fa-paperclip"></i> Financial Attachment</a>
            </li>
        </ul><!-- Tab panes -->
        <div class="tab-content">
            <div class="tab-pane active" id="tabs-1" role="tabpanel">
                <br>
                <table id="example" class="display">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Financial Class</th>
                            <th>Description</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for i in financial_classes %}
                        <tr>
                            <td>{{i.financial_id}}</td>
                            <td>{{i.financial_class}}</td>
                            <td>{{i.financial_description}}</td>
                            <td>
                                <a class="edit-finnancial-class" href="#" data-toggle="modal" data-target="#editModal" data-id="{{i.financial_id}}" data-name="{{i.financial_class}}" data-description="{{i.financial_description}}"><button class="btn btn-info">Edit</button></a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="editModalLabel">Edit CSO Type</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <form method="POST" enctype="multipart/form-data" action="{% url 'update_financial_class' %}">
                                    {% csrf_token %}
                                    <input type="hidden" id="financial_id" name="financial_id">
                                    <div class="form-group">
                                        <label for="financial_class">Financial Class</label>
                                        <input type="text" class="form-control" id="financial_class" name="financial_class" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="cso_prefix">Description</label>
                                        <input type="text" class="form-control" id="financial_description" name="financial_description" required>
                                    </div>
                                    <br>
                                    <button type="submit" class="btn btn-primary">Save changes</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>

            <div class="tab-pane" id="tabs-2" role="tabpanel">
                <br>
                <button type="button" class="btn btn-primary adding_icon" data-toggle="modal" data-target=".financial-bd-example-modal-lg">Add</button>
                <div class="modal fade financial-bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="editModalLabel">Add New Financial Group</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <i class="fa fa-times close" aria-hidden="true"></i>
                                </button>
                            </div>
                            <form class="financial_group" method="post" enctype="multipart/form-data" action="{% url 'create_new_financial_group' %}">
                                {% csrf_token %}
                                <div class="form-group">
                                    <label for="financial_group">Financial Group</label>
                                    <input type="text" class="form-control" placeholder="Type New Financial Group" id="financial_group" name="financial_group">
                                </div>
                                <div class="form-group">
                                    <label for="financial_description">Description</label>
                                    <input type="text" class="form-control" placeholder="Type Its Description" id="financial_description" name="financial_description">
                                </div>
                                <div class="form-group">
                                    <label for="financial_description">Financial Class</label>
                                    <select class="form-select" name="financial_class" id="financial_class">
                                        <option selected>Select A Class</option>
                                        <option value="Income">Income</option>
                                        <option value="Expenditure">Expenditure</option>
                                        <option value="Assets">Assets</option>
                                        <option value="Liabilities">Liabilities</option>
                                    </select>
                                </div>
                                <br>
                                <div class="modal-footer">
                                    <button type="submit" class="btn btn-primary">Save</button>
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                </div>
                                <br>
                                {% if error_msg %}
                                <div class="alert alert-danger" role="alert">
                                    {{ error_msg }}
                                </div>
                                {% endif %}
                            </form>
                        </div>
                    </div>
                </div>
                <br><br>
                <table id="thematic_area_table" class="display">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Financial Group</th>
                            <th>Description</th>
                            <th>Class</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for i in financial_groups %}
                        <tr>
                            <td>{{forloop.counter}}</td>
                            <td>{{i.financial_group_name}}</td>
                            <td>{{i.financial_description}}</td>
                            <td>{{i.financial_group_class}}</td>
                            <td>{{i.financial_group_status}}</td>
                            <td>
                                <div class="dropdown">
                                    <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        Click
                                    </button>
                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                        <a class="dropdown-item edit-btn-thematic" href="#" data-toggle="modal" data-target="#editModal_fGroup" data-id="{{i.financial_group_id}}" data-name="{{i.financial_group_name}}" data-description="{{i.financial_description}}" data-class="{{i.financial_group_class}}" data-status="{{i.financial_group_status}}"><button class="btn btn-info">Edit</button></a>
                                        <a class="dropdown-item"><button class="btn btn-danger" onclick="confirm_Fgroup_delete('{{ i.financial_group_id }}')">Delete</button></a>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <div class="modal fade" id="editModal_fGroup" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="editModalLabel">Edit Thematic CSO Type</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <form id="editForm" method="POST" enctype="multipart/form-data" action="{% url 'update_financial_group' %}">
                                    {% csrf_token %}
                                    <input type="hidden" id="financial_group_id" name="financial_group_id">
                                    <div class="form-group">
                                        <label for="financial_group_name">Type Of CSO</label>
                                        <input type="text" class="form-control" id="financial_group_name" name="financial_group_name" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="financial_description">financial_description</label>
                                        <input type="text" class="form-control" id="financial_description" name="financial_description" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="financial_group_class">financial_group_class</label>
                                        <select class="form-select" name="financial_group_class" id="financial_group_class">
                                            <option selected>Select a financial class</option>
                                            <option value="Income">Income</option>
                                            <option value="Expenditure">Expenditure</option>
                                            <option value="Assets">Assets</option>
                                            <option value="Liabilities">Liabilities</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Status</label><br>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" name="status" id="activeRadio" value="Active" checked>
                                            <label class="form-check-label" for="activeRadio">Active</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" name="status" id="inactiveRadio" value="Inactive">
                                            <label class="form-check-label" for="inactiveRadio">Inactive</label>
                                        </div>
                                    </div>
                                    <br>
                                    <button type="submit" class="btn btn-primary">Save changes</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>            
            
            <div class="tab-pane" id="tabs-3" role="tabpanel">
                <br>
                <button type="button" class="btn btn-primary adding_icon" data-toggle="modal" data-target=".attachment-bd-example-modal-lg">Add</button>
                <div class="modal fade attachment-bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="editModalLabel">Add New Attachment</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <i class="fa fa-times close" aria-hidden="true"></i>
                                </button>
                            </div>
                            <form class="attachment_form" method="post" enctype="multipart/form-data" action="{% url 'create_new_fattachment' %}">
                                {% csrf_token %}
                                <div class="row">
                                    <label for="attachment_name">New Attchment Name</label>
                                    <input type="text" class="form-control" placeholder="Type New Attachment" id="financial_attachments_name" name="financial_attachments_name">
                                </div><br>
                                <div class="row">
                                    <label for="attachment_description">New Attchment Description</label>
                                    <input type="text" class="form-control" placeholder="Type New Attachment Description" id="financial_description" name="financial_description">
                                </div><br>
                                <label>Public Display</label><br>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio1" value="Yes">
                                    <label class="form-check-label" for="inlineRadio1">Yes</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio2" value="No">
                                    <label class="form-check-label" for="inlineRadio2">No</label>
                                </div> <br><br>
                                <div class="d-flex align-items-center">
                                    <label class="me-2">Check The CSO Type:&nbsp;&nbsp;&nbsp;&nbsp;</label>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="checkbox" id="inlineCheckbox1" value="PBO" name="cso_types">
                                        <label class="form-check-label" for="inlineCheckbox1">PBO</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="checkbox" id="inlineCheckbox2" value="MBO" name="cso_types">
                                        <label class="form-check-label" for="inlineCheckbox2">MBO</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="checkbox" id="inlineCheckbox3" value="FCSO" name="cso_types">
                                        <label class="form-check-label" for="inlineCheckbox3">FCSO</label>
                                    </div>
                                </div>
                                
                                <br>
                                <div class="modal-footer">
                                    <button type="submit" class="btn btn-primary">Save</button>
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                </div>
                                <br>
                                {% if error_msg %}
                                <div class="alert alert-danger" role="alert">
                                    {{ error_msg }}
                                </div>
                                {% endif %}
                            </form>
                        </div>
                    </div>
                </div>
                <br><br>
                <table id="attachment_table" class="display">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Financial Attachment</th>
                            <th>Description</th>
                            <th>CSO Type</th>
                            <th>Public Display</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for i in financial_attachment %}
                        <tr>
                            <td>{{forloop.counter}}</td>
                            <td>{{i.financial_attachments_name}}</td>
                            <td>{{i.financial_description}}</td>
                            <td>{{i.attachment_cso_type}}</td>
                            <td>{{i.attachment_public_display}}</td>
                            <td>{{i.attachment_status}}</td>
                            <td>
                                <div class="dropdown">
                                    <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        Click
                                    </button>
                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                        <a class="dropdown-item edit-btn-attachment" href="#" data-toggle="modal" data-target="#editModal_attachment"
                                        data-id="{{i.financial_attachments_id}}"
                                        data-name="{{i.financial_attachments_name}}"
                                        data-description="{{i.financial_description}}"
                                        data-csotype="{{i.attachment_cso_type}}"
                                        data-public_view="{{i.attachment_public_display}}"
                                        data-status="{{i.attachment_status}}">
                                            <button class="btn btn-info">Edit</button>
                                        </a>
                                        <a class="dropdown-item"><button class="btn btn-danger" onclick="confirm_attachment_delete('{{ i.financial_attachments_id }}')">Delete</button></a>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <div class="modal fade" id="editModal_attachment" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="editModalLabel">Edit Financial Attachment</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <form id="editForm" method="POST" enctype="multipart/form-data" action="{% url 'update_finance_attachment' %}">
                                    {% csrf_token %}
                                    <input type="hidden" id="financial_attachments_id" name="financial_attachments_id">
                                    <div class="form-group">
                                        <label for="financial_attachments_name">Financial Attachment Name</label>
                                        <input type="text" class="form-control" id="financial_attachments_name" name="financial_attachments_name" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="financial_description">Description</label>
                                        <input type="text" class="form-control" id="financial_description" name="financial_description" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="attachment_public_display">Public Display</label>
                                        <select class="form-select" aria-label="Select a process" id="attachment_public_display" name="attachment_public_display" required>
                                            <option value="Yes">Yes</option>
                                            <option value="No">No</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="csotype">CSO Type</label> <br>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="checkbox" id="inlineCheckbox1" value="PBO" name="cso_types">
                                            <label class="form-check-label" for="inlineCheckbox1">PBO</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="checkbox" id="inlineCheckbox2" value="MBO" name="cso_types">
                                            <label class="form-check-label" for="inlineCheckbox2">MBO</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="checkbox" id="inlineCheckbox3" value="FCSO" name="cso_types">
                                            <label class="form-check-label" for="inlineCheckbox3">FCSO</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>Status</label><br>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" name="status" id="activeRadio" value="Active" checked>
                                            <label class="form-check-label" for="activeRadio">Active</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" name="status" id="inactiveRadio" value="Inactive">
                                            <label class="form-check-label" for="inactiveRadio">Inactive</label>
                                        </div>
                                    </div>
                                    <br>
                                    <button type="submit" class="btn btn-primary">Save changes</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>

        </div>
    </div>
</div>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
<script type="text/javascript">
    new DataTable('#example');
    new DataTable('#thematic_area_table');
    $('#attachment_table').DataTable({
        "pageLength": 50
    });
    new DataTable('#closing_table');
</script>
<script>
    // Adjust the width of the banner dynamically if needed
        function adjustBannerWidth() {
        const banner = document.querySelector('.banner');
        banner.style.width = `${window.innerWidth}px`;
    }

    // Call the function on load and resize
    window.onload = adjustBannerWidth;
    window.onresize = adjustBannerWidth;
</script>
<script>
    $(document).ready(function() {
        // Retrieve the active tab from localStorage
        var activeTab = localStorage.getItem('activeTab');
        if (activeTab) {
            $('.nav-tabs a[href="' + activeTab + '"]').tab('show');
        } else {
            $('.nav-tabs a[href="#tabs-1"]').tab('show'); // Default tab
        }

        // Save the active tab to localStorage
        $('a[data-toggle="tab"]').on('shown.bs.tab', function(e) {
            var currentTab = $(e.target).attr('href');
            localStorage.setItem('activeTab', currentTab);
        });

        // Event handler for clicking the edit button
        $('.edit-finnancial-class').on('click', function(event) {
            event.preventDefault();

            // Retrieve data attributes from the clicked element
            var FclassId = $(this).data('id');
            var FclassName = $(this).data('name');
            var FclassDescription = $(this).data('description');

            // Populate modal form fields with retrieved data
            $('#editModal #financial_id').val(FclassId);
            $('#editModal #financial_class').val(FclassName);
            $('#editModal #financial_description').val(FclassDescription);
            // Update modal title dynamically
            $('#editModal .modal-title').text('Edit Financial Class Type - ' + FclassName);
        });

        $('.edit-btn-thematic').on('click', function(event) {
            event.preventDefault();

            // Retrieve data attributes from the clicked element
            var fGroupId = $(this).data('id');
            var fGroupName = $(this).data('name');
            var fGroupDescription = $(this).data('description');
            var fGroupClass = $(this).data('class');
            var status = $(this).data('status');

            // Populate modal form fields with retrieved data
            $('#editModal_fGroup #financial_group_id').val(fGroupId);
            $('#editModal_fGroup #financial_group_name').val(fGroupName);
            $('#editModal_fGroup #financial_description').val(fGroupDescription);
            $('#editModal_fGroup #financial_group_class').val(fGroupClass);
            $('#editModal_fGroup #financial_group_status').val(status);

            // Set the status radio button
            if (status === 'Active') {
                $('#editModal_fGroup #activeRadio').prop('checked', true);
            } else {
                $('#editModal_fGroup #inactiveRadio').prop('checked', true);
            }

            // Update modal title dynamically
            $('#editModal_fGroup .modal-title').text('Edit Thematic CSO Type - ' + csoName);
        });
        //attachment autofill
        $('.edit-btn-attachment').on('click', function(event) {
            event.preventDefault();

            // Retrieve data attributes from the clicked element
            var attachmentId = $(this).data('id');
            var attachmentName = $(this).data('name');
            var description = $(this).data('description');
            var display = $(this).data('public_view'); // Corrected data attribute name
            var csotype = $(this).data('csotype');
            var status = $(this).data('status');
            
            console.log(csotype, "here");

            // Populate modal form fields with retrieved data
            $('#editModal_attachment #financial_attachments_id').val(attachmentId);
            $('#editModal_attachment #financial_attachments_name').val(attachmentName);
            $('#editModal_attachment #financial_description').val(description);
            $('#editModal_attachment #attachment_public_display').val(display);
            
            // Uncheck all checkboxes
            $('#editModal_attachment input[type=checkbox]').prop('checked', false);

            // Split and trim the CSO type values, then check the corresponding checkboxes
            var csotypeArray = csotype.split(',').map(function(item) {
                return item.trim(); // Trim whitespace from each item
            });
            csotypeArray.forEach(function(type) {
                $('#editModal_attachment input[type=checkbox][value="' + type + '"]').prop('checked', true);
            });

            // Set the status radio button
            if (status === 'Active') {
                $('#editModal_attachment #activeRadio').prop('checked', true);
            } else {
                $('#editModal_attachment #inactiveRadio').prop('checked', true);
            }

            // Update modal title dynamically
            $('#editModal_attachment .modal-title').text('Edit Financial Attachment - ' + attachmentName);
        });


        $('.edit-btn-closing').on('click', function(event) {
            event.preventDefault();
            
            // Retrieve data attributes from the clicked element
            var closingId = $(this).data('id');
            var closingType = $(this).data('name');
            var closingDescription = $(this).data('description');
            var status = $(this).data('status');
            
            // Populate modal form fields with retrieved data
            $('#editModal_closing #cso_closing_id').val(closingId);
            $('#editModal_closing #cso_closing_type').val(closingType);
            $('#editModal_closing #cso_closing_description').val(closingDescription);
            
            // Set the status radio button
            if (status === 'Active') {
                $('#editModal_closing #activeRadio').prop('checked', true);
            } else {
                $('#editModal_closing #inactiveRadio').prop('checked', true);
            }
            
            // Update modal title dynamically
            $('#editModal_closing .modal-title').text('Edit Closing Type - ' + closingType);
        });

    });
    

    function confirm_cso_delete(cso_id) {
        Swal.fire({
            title: "Are you sure you want to delete this CSO?",
            showCancelButton: true,
            confirmButtonText: "Yes, delete it!",
            cancelButtonText: "No, cancel!"
        }).then((result) => {
            if (result.isConfirmed) {
                fetch('{% url "delete_cso" 9999 %}'.replace('9999', cso_id), {
                    method: 'POST',
                    headers: {
                        'X-CSRFToken': '{{ csrf_token }}',
                    }
                }).then(response => {
                    if (response.ok) {
                        Swal.fire("Deleted!", "The CSO has been deleted.", "success").then(() => {
                            window.location.reload(); // Reload the page after deletion
                        });
                    } else {
                        Swal.fire("Failed!", "Failed to delete CSO.", "error");
                    }
                });
            } else if (result.dismiss === Swal.DismissReason.cancel) {
                Swal.fire("Cancelled", "Your CSO is safe :)", "info");
            }
        });
    }
    function confirm_Fgroup_delete(financial_group_id) {
        Swal.fire({
            title: "Are you sure you want to delete this financial group?",
            showCancelButton: true,
            confirmButtonText: "Yes, delete it!",
            cancelButtonText: "No, cancel!"
        }).then((result) => {
            if (result.isConfirmed) {
                fetch('{% url "delete_financial_group" 9999 %}'.replace('9999', financial_group_id), {
                    method: 'POST',
                    headers: {
                        'X-CSRFToken': '{{ csrf_token }}',
                    }
                }).then(response => {
                    if (response.ok) {
                        Swal.fire("Deleted!", "The financial group has been deleted.", "success").then(() => {
                            window.location.reload(); // Reload the page after deletion
                        });
                    } else {
                        Swal.fire("Failed!", "Failed to delete financial group.", "error");
                    }
                });
            } else if (result.dismiss === Swal.DismissReason.cancel) {
                Swal.fire("Cancelled", "Your financial group is safe :)", "info");
            }
        });
    }

    function confirm_attachment_delete(financial_attachments_id) {
        Swal.fire({
            title: "Are you sure you want to delete this Attachment?",
            showCancelButton: true,
            confirmButtonText: "Yes, delete it!",
            cancelButtonText: "No, cancel!"
        }).then((result) => {
            if (result.isConfirmed) {
                fetch('{% url "delete_financial_attachment" 9999 %}'.replace('9999', financial_attachments_id), {
                    method: 'POST',
                    headers: {
                        'X-CSRFToken': '{{ csrf_token }}',
                    }
                }).then(response => {
                    if (response.ok) {
                        Swal.fire("Deleted!", "The Attachment has been deleted.", "success").then(() => {
                            window.location.reload(); // Reload the page after deletion
                        });
                    } else {
                        Swal.fire("Failed!", "Failed to delete Attachment.", "error");
                    }
                });
            } else if (result.dismiss === Swal.DismissReason.cancel) {
                Swal.fire("Cancelled", "Your attachment is safe :)", "info");
            }
        });
    }

    function confirm_closing_delete(cso_closing_id) {
        Swal.fire({
            title: "Are you sure you want to delete this closing type?",
            showCancelButton: true,
            confirmButtonText: "Yes, delete it!",
            cancelButtonText: "No, cancel!"
        }).then((result) => {
            if (result.isConfirmed) {
                fetch('{% url "delete_closing_type" 9999 %}'.replace('9999', cso_closing_id), {
                    method: 'POST',
                    headers: {
                        'X-CSRFToken': '{{ csrf_token }}',
                    }
                }).then(response => {
                    if (response.ok) {
                        Swal.fire("Deleted!", "The closing type has been deleted.", "success").then(() => {
                            window.location.reload(); // Reload the page after deletion
                        });
                    } else {
                        Swal.fire("Failed!", "Failed to delete closing type.", "error");
                    }
                });
            } else if (result.dismiss === Swal.DismissReason.cancel) {
                Swal.fire("Cancelled", "Your closing type is safe :)", "info");
            }
        });
    }
</script>
{% endblock %}
